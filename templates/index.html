{#{% load static %}#}
{#<!DOCTYPE html>#}
{#<html lang="en">#}
{#<head>#}
{#    <meta charset="UTF-8">#}
{#    <meta name="viewport" content="width=device-width, initial-scale=1.0">#}
{#    <title>Star Rating</title>#}
{#</head>#}
{#<style>#}
{#    body {#}
{#        font-family: Arial, sans-serif;#}
{#        display: flex;#}
{#        justify-content: center;#}
{#        align-items: center;#}
{#        height: 100vh;#}
{#        flex-direction: column;#}
{#    }#}
{##}
{#    .text p {#}
{#        font-size: 28px; /* –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä —Ç–µ–∫—Å—Ç–∞ */#}
{#    }#}
{##}
{#    .star-rating {#}
{#        display: flex;#}
{#        font-size: 4rem; /* –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä –∑–≤–µ–∑–¥–æ—á–µ–∫ */#}
{#        color: #ddd; /* Default color of stars */#}
{#        cursor: pointer; /* –ú–µ–Ω—è–µ–º –∫—É—Ä—Å–æ—Ä –Ω–∞ pointer –¥–ª—è –≤—Å–µ–≥–æ –±–ª–æ–∫–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞ */#}
{#    }#}
{##}
{#    .star-selected {#}
{#        color: #ffd700; /* Color of unselected stars when hovering */#}
{#    }#}
{##}
{#    .star-rating .star.selected {#}
{#        color: #ddd; /* Color of selected stars */#}
{#    }#}
{##}
{#</style>#}
{#<body>#}
{##}
{#<div class="text">#}
{#    <p>–û—Ü–µ–Ω–∏—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ —Ä–∞–±–æ—Ç—ãüëç</p>#}
{#</div>#}
{##}
{#<div class="star-rating" data-application-id="{{ application.slug }}">#}
{#    <span class="star" data-value="1">&#9733;</span>#}
{#    <span class="star" data-value="2">&#9733;</span>#}
{#    <span class="star" data-value="3">&#9733;</span>#}
{#    <span class="star" data-value="4">&#9733;</span>#}
{#    <span class="star" data-value="5">&#9733;</span>#}
{#</div>#}
{##}
{##}
{#<script>#}
{#    let rating = 0;#}
{#    const textElement = document.querySelector('.text');#}
{#    const stars = document.querySelectorAll('.star');#}
{##}
{#    function getCookie(name) {#}
{#        let cookies = document.cookie.split(';');#}
{#        for (let i = 0; i < cookies.length; i++) {#}
{#            let cookie = cookies[i].trim();#}
{#            if (cookie.startsWith(name + '=')) {#}
{#                if (name === 'rating') {#}
{#                    rating = cookie.substring(name.length + 1);#}
{#                    if (textElement) {#}
{#                        textElement.innerHTML = `<p>–°–ø–∞—Å–∏–±–æ –∑–∞ –æ—Ü–µ–Ω–∫—É –º—ã —ç—Ç–æ —Ü–µ–Ω–∏–º, –≤–∞—à–∞ –æ—Ü–µ–Ω–∫–∞ ${rating}/5üëç</p>`;#}
{#                        for (let i = 0; i < rating; i++) {#}
{#                            stars[i].className = 'star-selected';#}
{#                        }#}
{#                    }#}
{#                }#}
{#                return cookie.substring(name.length + 1);#}
{#            }#}
{#        }#}
{#        return 0;#}
{#    }#}
{##}
{#    getCookie('rating');#}
{##}
{#    if (rating === 0) {#}
{#        stars.forEach(item => {#}
{#            item.addEventListener('click', function () {#}
{#                const score = item.getAttribute('data-value');#}
{#                const applicationId = this.parentNode.getAttribute('data-application-id');#}
{#                fetch(`/rate-application/${applicationId}/`, {#}
{#                    method: 'POST',#}
{#                    body: JSON.stringify({'score': score}),#}
{#                    headers: {#}
{#                        'Content-Type': 'application/json',#}
{#                        'X-CSRFToken': getCookie('csrftoken'),#}
{#                    }#}
{#                })#}
{#                    .then(response => {#}
{#                        response.json();#}
{#                        document.cookie = `rating=${score};`;#}
{#                    })#}
{#                    .then(() => {#}
{#                        getCookie('rating');#}
{#                    })#}
{#                    .catch(error => console.error('Error:', error));#}
{#            }, {once: true});#}
{#        });#}
{#    } else if (rating > 0) {#}
{#        for (let i = 0; i < 5; i++) {#}
{#            stars[i].className = 'star';#}
{#        }#}
{#        if (textElement) {#}
{#            textElement.innerHTML = `<p>–í–∞—à–∞ –æ—Ü–µ–Ω–∫–∞ ${rating}/5üëç</p>`;#}
{#            for (let i = 0; i < rating; i++) {#}
{#                stars[i].className = 'star-selected';#}
{#            }#}
{#        }#}
{#    }#}
{#</script>#}
{#</body>#}
{#</html>#}



{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Star Rating</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            flex-direction: column;
            margin: 0;
            background-color: #f0f0f0;
        }

        .text p {
            font-size: 24px; /* Adjusted text size */
            text-align: center;
        }

.container {
    display: flex;
    align-items: center; /* –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ */
    justify-content: space-around; /* –†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –º–µ–∂–¥—É —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ */
    width: 100%;
    max-width: 800px; /* –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ */
    margin: auto; /* –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ */
}
    .star-rating {
    display: flex;
    {#justify-content: flex-end; /* –ù–∞—á–∞–ª–æ –æ—Ç—Å—á—ë—Ç–∞ –∑–≤—ë–∑–¥ —Å –ø—Ä–∞–≤–æ–π —Å—Ç–æ—Ä–æ–Ω—ã */#}
    {#flex-direction: row-reverse; /* –†–∞–∑–≤–æ—Ä–æ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–≤—ë–∑–¥ */#}
    font-size: 3rem;
    color: #ddd;
    cursor: pointer;
}

        .star-rating .star {
            color: #ddd; /* Default color of stars */
            transition: color 0.2s; /* Smooth transition for color change */
        }

        {#.star-rating .star:hover,#}
        {#.star-rating .star:hover ~ .star { /* Changes color when hovered */#}
        {#    color: #ffd700; /* Gold color for hovered stars */#}
        {#}#}

       textarea {
    width: 100%; /* –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —à–∏—Ä–∏–Ω—ã –ø–æ–ª—è –æ—Ç–∑—ã–≤–∞ */
    height: 100px;
    margin-right: 20px; /* –û—Ç—Å—Ç—É–ø —Å–ø—Ä–∞–≤–∞ */
}
    </style>
</head>
<body>

<div class="text">
    <p>–û—Ü–µ–Ω–∏—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ —Ä–∞–±–æ—Ç—ãüëç</p>
</div>

<!-- Textarea for comments -->
<div>
    <textarea id="ratingMessage" placeholder="–û—Å—Ç–∞–≤—å—Ç–µ –≤–∞—à –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∑–¥–µ—Å—å..."></textarea>
</div>

<div class="star-rating" data-application-id="{{ application.slug }}">
    <span class="star" data-value="1">&#9733;</span>
    <span class="star" data-value="2">&#9733;</span>
    <span class="star" data-value="3">&#9733;</span>
    <span class="star" data-value="4">&#9733;</span>
    <span class="star" data-value="5">&#9733;</span>
</div>
 <button type="button" class="btn btn-primary" onclick="onSubmit()">–û—Ü–µ–Ω–∏—Ç—å</button>
<script>
    document.addEventListener('DOMContentLoaded', () => {
    const stars = document.querySelectorAll('.star');
    const starRating = document.querySelector('.star-rating');
    const applicationId = starRating.getAttribute('data-application-id');
    let currentRating = parseInt(localStorage.getItem(`rated${applicationId}`), 10);

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–¥—Å–≤–µ—Ç–∫–∏ –∑–≤–µ–∑–¥
    function highlightStars(value) {
        stars.forEach((star, index) => {
            star.style.color = index < value ? '#ffd700' : '#ddd';
        });
    }

    if (currentRating) {
        highlightStars(currentRating);
    }

    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∏–∫–æ–≤ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑
    stars.forEach((star, index) => {
        star.addEventListener('click', function () {
            if (!currentRating) {
                const rating = index + 1;
                currentRating = rating;
                localStorage.setItem(`rated${applicationId}`, rating.toString());
                highlightStars(rating);

                // –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ä–µ–π—Ç–∏–Ω–≥–∞ –¥–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏—è
                addHoverEffect();

                const message = document.getElementById('ratingMessage').value;
                fetch(`/rate-application/${applicationId}/`, {
                    method: 'POST',
                    body: JSON.stringify({'score': rating, 'message': message}),
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': getCookie('csrftoken'),
                    }
                })
                .then(response => response.json())
                .then(() => console.log('Rating submitted successfully'))
                .catch(error => console.error('Error:', error));
            }
        });
    });

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∞ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏
    function addHoverEffect() {
        stars.forEach((star, index) => {
            star.addEventListener('mouseover', () => highlightStars(index + 1));
            star.addEventListener('mouseout', () => highlightStars(currentRating));
        });
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è CSRF —Ç–æ–∫–µ–Ω–∞ –∏–∑ –∫—É–∫
    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                const cookie = cookies[i].trim();
                if (cookie.startsWith(name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
    function onSubmit (){

    }
});



</script>

</body>
</html>
